//*****************************************************************************
//*****************************************************************************
//*                                                                           *
//*  X86 - IO32 (I/O Port 32-bit)                                             *
//*                                                                           *
//*****************************************************************************
//*****************************************************************************
#ifndef __X86_IO32_H
#define __X86_IO32_H

#include "typedef.h"

//#############################################################################
//  __BORLANDC__
//#############################################################################
#ifdef __BORLANDC__

//=============================================================================
//  ind
//=============================================================================
static const uint8_t g_inportd[] =
{							// BITS 16
	0x55,					// push bp
	0x8B, 0xEC,				//  mov bp,sp
	0x8B, 0x56, 0x06,		//  mov dx,[bp + 6]
	0x66, 0xED,				//  in eax,dx
	0x8B, 0xD0,				//  mov dx,ax
	0x66, 0xC1, 0xE8, 0x10,	//  shr eax,16
	0x92,					//  xchg dx,ax
	0x5D,					// pop bp
	0xCB					// retf
};
static uint32_t far cdecl (*ind)(uint16_t port) =
	(uint32_t far (*)(uint16_t))g_inportd;

//=============================================================================
//  outd
//=============================================================================
static const uint8_t g_outportd[] =
{							// BITS 16
	0x55,					// push bp
	0x8B, 0xEC,				//  mov bp,sp
	0x8B, 0x56, 0x06,		//  mov dx,[bp + 6]
	0x66, 0x8B, 0x46, 0x08,	//  mov eax,[bp + 8]
	0x66, 0xEF,				//  out dx,eax
	0x5D,					// pop bp
	0xCB					// retf
};
static void far cdecl (*outd)(uint16_t port, uint32_t val) =
	(void far (*)(uint16_t, uint32_t))g_outportd;

#endif

//#############################################################################
//  __WATCOMC__
//#############################################################################
#ifdef __WATCOMC__

// rename io32.h to x86io32.h to avoid conflict duplicated file
//#include <conio.h>

#define ind(p)		inpd(p)
#define	outd(p, d)	outpd(p, d)

#endif



#endif
